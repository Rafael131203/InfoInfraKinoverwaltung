@page "/"
@using KinoAppShared.DTOs.Imdb
@using KinoAppWeb.Services

<PageTitle>KinoApp – Retro Cinema Experience</PageTitle>

<!-- HERO SECTION: CAMERA + SLIDER -->
<section class="hero" aria-labelledby="hero-title">
    <div class="hero__layout">
        <!-- LEFT: TEXT + CAMERA -->
        <div class="hero__column hero__column--left">
            <header class="hero-copy">
                <p class="hero-copy__eyebrow">Retro Cinema • Modern Comfort</p>
                <h1 id="hero-title" class="hero-copy__title">
                    Experience cinema like
                    <span class="hero-copy__highlight">the golden age of film.</span>
                </h1>
                <p class="hero-copy__subtitle">
                    Select your movie, reserve your seat and let the old-school projector
                    light up your night – all from your browser.
                </p>
            </header>

            <ul class="hero-features" aria-label="Cinema highlights">
                <li class="hero-features__item">4K Remasters</li>
                <li class="hero-features__item">Dolby Atmos Sound</li>
                <li class="hero-features__item">Original Version &amp; DE Subs</li>
            </ul>

            <div class="hero-actions">
                <button class="btn btn--primary" type="button">
                    Book Tickets
                </button>
                <button class="btn btn--ghost" type="button">
                    View Schedule
                </button>
            </div>

            <!-- ENHANCED OLD CINEMA CAMERA BLOCK -->
            <aside class="camera-block" aria-label="Retro cinema projector illustration">
                <div class="camera-block__inner">
                    <!-- Top bar for extra depth -->
                    <div class="camera-top">
                        <div class="camera-top__plate">
                            <span class="camera-top__bolt camera-top__bolt--left"></span>
                            <span class="camera-top__bolt camera-top__bolt--right"></span>
                            <span class="camera-top__handle"></span>
                        </div>
                    </div>

                    <!-- Reels assembly -->
                    <div class="camera-reels">
                        <div class="camera-reel camera-reel--left">
                            <span class="camera-reel__ring"></span>
                            <span class="camera-reel__spoke camera-reel__spoke--v"></span>
                            <span class="camera-reel__spoke camera-reel__spoke--h"></span>
                            <span class="camera-reel__hub"></span>
                        </div>
                        <div class="camera-reel camera-reel--right">
                            <span class="camera-reel__ring"></span>
                            <span class="camera-reel__spoke camera-reel__spoke--v"></span>
                            <span class="camera-reel__spoke camera-reel__spoke--h"></span>
                            <span class="camera-reel__hub"></span>
                        </div>
                    </div>

                    <!-- Main body -->
                    <div class="camera-body">
                        <div class="camera-body__front">
                            <!-- Lens stack -->
                            <div class="camera-lens">
                                <div class="camera-lens__ring camera-lens__ring--outer"></div>
                                <div class="camera-lens__ring camera-lens__ring--mid"></div>
                                <div class="camera-lens__ring camera-lens__ring--inner"></div>
                                <div class="camera-lens__glass">
                                    <div class="camera-lens__reflection camera-lens__reflection--primary"></div>
                                    <div class="camera-lens__reflection camera-lens__reflection--secondary"></div>
                                </div>
                                <div class="camera-lens__glow"></div>
                            </div>

                            <!-- Viewfinder & controls -->
                            <div class="camera-body__panel">
                                <div class="camera-panel__row camera-panel__row--status">
                                    <span class="camera-status-dot camera-status-dot--red"></span>
                                    <span class="camera-status-dot camera-status-dot--amber"></span>
                                    <span class="camera-status-dot camera-status-dot--green"></span>
                                    <span class="camera-panel__label">REC</span>
                                </div>

                                <div class="camera-panel__row camera-panel__row--slider">
                                    <span class="camera-slider__track">
                                        <span class="camera-slider__fill"></span>
                                        <span class="camera-slider__thumb"></span>
                                    </span>
                                </div>

                                <div class="camera-panel__row camera-panel__row--meters">
                                    <span class="camera-meter camera-meter--left"></span>
                                    <span class="camera-meter camera-meter--right"></span>
                                </div>
                            </div>
                        </div>

                        <!-- Side panel with film door -->
                        <div class="camera-body__side">
                            <div class="camera-side__door">
                                <span class="camera-side__hinge"></span>
                                <span class="camera-side__screw camera-side__screw--top"></span>
                                <span class="camera-side__screw camera-side__screw--bottom"></span>
                                <span class="camera-side__label">35mm</span>
                            </div>

                            <div class="camera-side__vents">
                                <span class="camera-vent"></span>
                                <span class="camera-vent"></span>
                                <span class="camera-vent"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Tripod / base -->
                    <div class="camera-base">
                        <div class="camera-base__plate"></div>
                        <div class="camera-tripod">
                            <span class="camera-tripod__leg camera-tripod__leg--left"></span>
                            <span class="camera-tripod__leg camera-tripod__leg--center"></span>
                            <span class="camera-tripod__leg camera-tripod__leg--right"></span>
                        </div>
                    </div>

                    <!-- Light cone pointing towards the slider -->
                    <div class="camera-light-cone">
                        <div class="camera-light-cone__inner"></div>
                    </div>
                </div>

                <p class="camera-block__caption">
                    Authentic projector-inspired animation: spinning reels, layered lens glow,
                    film-door details and a warm beam casting across the feature slider.
                </p>
            </aside>
        </div>

        <!-- RIGHT: IMAGE SLIDER -->
        <div class="hero__column hero__column--right">
            <section class="hero-slider"
                     aria-label="Featured screenings"
                     data-slider="hero"
                     data-slider-interval="5000">

                <!-- Shutter layers -->
                <div class="hero-slider__shutter hero-slider__shutter--top" aria-hidden="true"></div>
                <div class="hero-slider__shutter hero-slider__shutter--bottom" aria-hidden="true"></div>

                <div class="hero-slider__frame">
                    <div class="hero-slider__inner">
                        @if (_featured is not null && _featured.Count > 0)
                        {
                            var totalSlides = Math.Max(_featured.Count, 3); // ensure 3 slides

                            for (var i = 0; i < totalSlides; i++)
                            {
                                var movie = i < _featured.Count ? _featured[i] : null;
                                var slideClasses = i == 0
                                ? "hero-slide hero-slide--active"
                                : "hero-slide";

                                <article class="@slideClasses"
                                         data-slide-index="@i"
                                         aria-label="@(movie?.Titel ?? "Coming soon")">

                                    <div class="hero-slide__image-wrapper">
                                        <img src="@(string.IsNullOrWhiteSpace(movie?.ImageURL)
                                            ? "images/download (1).jpg"
                                            : movie.ImageURL)"
                                         alt="@(movie?.Titel ?? "Coming soon") poster"
                                         class="hero-slide__image" />

                            </div>

                                    <div class="hero-slide__gradient" aria-hidden="true"></div>

                                    <div class="hero-slide__content">
                                        <div class="hero-slide__text">
                                            <h2 class="hero-slide__title">
                                                @(movie?.Titel ?? "More great movies coming soon")
                                            </h2>

                                            <p class="hero-slide__meta">
                                        @if (movie?.Fsk is int fsk)
                                                {
                                                    @($"FSK {fsk}")
                                                }
                                                @if (movie?.Dauer is int mins)
                                                {
                                                    @($" · {mins} min")
                                                }
                                                @if (!string.IsNullOrWhiteSpace(movie?.Genre))
                                                {
                                                    @(" · " + movie.Genre)
                                                }
                                            </p>
                                        </div>

                                        <span class="hero-slide__badge hero-slide__badge--primary">
                                            Now showing
                                        </span>
                                    </div>
                                </article>
                            }
                        }
                        else
                        {
                            <!-- No data at all: keep your single static fallback -->
                            <article class="hero-slide hero-slide--active"
                                     data-slide-index="0"
                                     aria-label="Retro Sci-Fi Night">
                                <div class="hero-slide__image-wrapper">
                                    <img src="images/download (1).jpg"
                                         alt="Stylized futuristic city skyline with neon lights, retro sci-fi style poster"
                                         class="hero-slide__image" />
                                </div>
                                <div class="hero-slide__gradient" aria-hidden="true"></div>

                                <div class="hero-slide__content">
                                    <div class="hero-slide__text">
                                        <h2 class="hero-slide__title">Retro Sci-Fi Night</h2>
                                        <p class="hero-slide__meta">
                                            Double feature of cult classics · 20:00 &amp; 23:00 · OV with DE subtitles
                                        </p>
                                    </div>
                                    <span class="hero-slide__badge hero-slide__badge--primary">
                                        Tonight
                                    </span>
                                </div>
                            </article>
                        }
                    </div>

                    <!-- Controls & dots -->
                    <div class="hero-slider__controls" aria-hidden="false">
                        <button class="hero-slider__arrow hero-slider__arrow--prev"
                                type="button"
                                aria-label="Previous slide"
                                data-slider-prev>
                            ‹
                        </button>

                        <button class="hero-slider__arrow hero-slider__arrow--next"
                                type="button"
                                aria-label="Next slide"
                                data-slider-next>
                            ›
                        </button>

                        <div class="hero-slider__dots" role="tablist" aria-label="Select featured slide">
                            @if (_featured is not null && _featured.Count > 0)
                            {
                                var totalSlides = Math.Max(_featured.Count, 3);

                                for (var i = 0; i < totalSlides; i++)
                                {
                                    var dotClasses = i == 0
                                    ? "hero-slider__dot hero-slider__dot--active"
                                    : "hero-slider__dot";

                                    <button class="@dotClasses"
                                            type="button"
                                            role="tab"
                                            aria-label="@($"Slide {i + 1}")"
                                            aria-selected="@(i == 0 ? "true" : "false")"
                                            data-slider-dot="@i">
                                    </button>
                                }
                            }
                            else
                            {
                                <button class="hero-slider__dot hero-slider__dot--active"
                                        type="button"
                                        role="tab"
                                        aria-label="Slide 1"
                                        aria-selected="true"
                                        data-slider-dot="0">
                                </button>
                            }
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</section>

<!-- NOW SHOWING SECTION -->
<section id="now-showing" class="section section--now-showing" aria-labelledby="now-showing-title">
    <header class="section__header">
        <div class="section__header-left">
            <p class="section__eyebrow">Now Showing</p>
            <h2 id="now-showing-title" class="section__title">Pick your feature</h2>
        </div>
        <div class="section__header-right">
            <form class="movie-filters" aria-label="Filter movies">
                <!-- GENRE FILTER -->
                <label class="movie-filters__group">
                    <span class="movie-filters__label">Genre</span>
                    <select class="movie-filters__select"
                            value="@_selectedGenre"
                            @onchange="OnGenreChanged">
                        <option value="">All</option>
                        <option value="Action">Action</option>
                        <option value="Adventure">Adventure</option>
                        <option value="Comedy">Comedy</option>
                        <option value="Drama">Drama</option>
                        <option value="Sci-Fi">Sci-Fi</option>
                        <option value="Horror">Horror</option>
                        <option value="Animation">Animation</option>
                    </select>
                </label>

                <!-- LANGUAGE FILTER (placeholder, no effect until stored on FilmDto) -->
                <label class="movie-filters__group">
                    <span class="movie-filters__label">Language</span>
                    <select class="movie-filters__select"
                            value="@_selectedLanguage"
                            @onchange="OnLanguageChanged">
                        <option value="all">All</option>
                        <option value="US">English</option>
                        <option value="DE">Deutsch</option>
                        <option value="FR">Français</option>
                        <option value="NL">Nederlands</option>
                    </select>
                </label>

                <!-- SORT BY -->
                <label class="movie-filters__group">
                    <span class="movie-filters__label">Sort by</span>
                    <select class="movie-filters__select"
                            value="@_selectedSort"
                            @onchange="OnSortChanged">
                        <option value="SORT_BY_POPULARITY">Popularity (by title)</option>
                        <option value="SORT_BY_RELEASE_DATE">Release date</option>
                        <option value="SORT_BY_USER_RATING">User rating</option>
                        <option value="SORT_BY_USER_RATING_COUNT">Rating count</option>
                        <option value="SORT_BY_YEAR">Year</option>
                    </select>
                </label>
            </form>
        </div>
    </header>

    <div class="movie-grid" aria-label="Movies currently playing">

        @foreach (var movie in _grid)
        {
            <article class="movie-card">

                <a href="@($"/movie/{movie.Id}")"
                   class="movie-card__link"
                   aria-label="@movie.Titel">

                    <!-- POSTER -->
                    <div class="movie-card__poster">
                        <img src="@(string.IsNullOrWhiteSpace(movie.ImageURL)
                            ? "images/download (1).jpg"
                            : movie.ImageURL)"
                         alt="@movie.Titel"
                         class="movie-card__poster-image"
                         loading="lazy" />
                </div>

                    <div class="movie-card__body">
                        <!-- TITLE -->
                        <h3 class="movie-card__title">@movie.Titel</h3>

                        <!-- META INFO -->
                        <p class="movie-card__meta">
                        @if (movie.Fsk.HasValue)
                            {
                                @($"FSK {movie.Fsk} · ")
                            }

                            @if (!string.IsNullOrWhiteSpace(movie.Genre))
                            {
                                @movie.Genre
                            }

                            @if (movie.Dauer.HasValue)
                            {
                                @($" · {movie.Dauer} min")
                            }
                        </p>

                        <!-- DESCRIPTION -->
                        <p class="movie-card__description">
                            @movie.Beschreibung
                        </p>

                        <div class="movie-card__footer">

                            <div class="movie-card__badges">
                                @if (movie.Dauer.HasValue)
                                {
                                    <span class="movie-card__badge-age">
                                        @($"{movie.Dauer} min")
                                    </span>
                                }

                                @if (movie.Fsk.HasValue)
                                {
                                    <span class="movie-card__badge-format">
                                        @($"FSK {movie.Fsk}")
                                    </span>
                                }
                            </div>

                        </div>

                    </div>

                </a>

            </article>
        }

    </div>

</section>

<!-- COMING SOON STRIP -->
<section id="coming-soon" class="section section--strip" aria-labelledby="coming-soon-title">
    <header class="section__header section__header--compact">
        <div>
            <p class="section__eyebrow">Coming Soon</p>
            <h2 id="coming-soon-title" class="section__title">Sneak a peek</h2>
        </div>
    </header>

    <div class="strip-carousel" aria-label="Upcoming movies">
        <article class="strip-item">
            <h3 class="strip-item__title">Moonlight Over Berlin</h3>
            <p class="strip-item__meta">Romance · FSK 6 · From 12 Dec</p>
        </article>
        <article class="strip-item">
            <h3 class="strip-item__title">The Silent Orchestra</h3>
            <p class="strip-item__meta">Drama · Live score · One-night event</p>
        </article>
        <article class="strip-item">
            <h3 class="strip-item__title">Circuit Breakers</h3>
            <p class="strip-item__meta">Action · FSK 12 · Premiere soon</p>
        </article>
    </div>
</section>

<!-- SPECIAL EVENTS / ABOUT -->
<section id="special-events" class="section section--split" aria-labelledby="special-events-title">
    <div class="section__split">
        <div class="section__split-col">
            <header class="section__header">
                <p class="section__eyebrow">Special Events</p>
                <h2 id="special-events-title" class="section__title">
                    Theme nights, marathons &amp; live guests
                </h2>
            </header>
            <p class="section__text">
                From horror marathons on long autumn nights to Q&amp;A sessions with directors,
                KinoApp’s curated events make each visit feel like a premiere.
            </p>
            <ul class="bullet-list">
                <li class="bullet-list__item">Live score screenings with local musicians</li>
                <li class="bullet-list__item">Classic 35mm film prints on selected weekends</li>
                <li class="bullet-list__item">Surprise sneak previews every month</li>
            </ul>
        </div>

        <div class="section-divider"></div>

        <div id="about" class="section__split-col">
            <header class="section__header">
                <p class="section__eyebrow">About the cinema</p>
                <h2 class="section__title">Built for film lovers</h2>
            </header>
            <p class="section__text">
                KinoApp is a concept for a cinema interface that blends retro aesthetics with
                modern booking flows. Select a movie, choose your seat, and keep that classic
                projector feeling alive in every interaction.
            </p>

            <form class="newsletter" aria-label="Sign up for newsletter">
                <label class="newsletter__label" for="newsletter-email">
                    Stay in the reel: get updates on new screenings and events.
                </label>
                <div class="newsletter__controls">
                    <input id="newsletter-email"
                           class="newsletter__input"
                           type="email"
                           name="email"
                           placeholder="you@example.com"
                           required />
                    <button class="btn btn--primary newsletter__button" type="submit">
                        Sign up
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- NOW SHOWING -->
<section id="now-showing" class="section section--now-showing" aria-labelledby="now-showing-title">
    <!-- extra anchor section, kept for layout / future content -->
</section>
